<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="../src/css/index.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.2.0/chart.min.js"></script>
    <style>
        .chart-con {
            position: relative;
        }
        
        .chart-rail {
            overflow: scroll;
        }
        
        .chart {
            background: white;
            display: flex;
            position: relative;
            margin-bottom: 30px;
            ;
        }
        
        .chart-wrap {
            width: calc(100% - 100px);
            position: relative;
        }
        
        .chart canvas {
            /* border: 1px solid red; */
        }
        
        .chart-target {
            position: absolute;
            height: 2px;
            background: rgba(0, 0, 0, 0.1);
            width: 100%;
            top: 20%;
            left: 0;
            transform: translateY(1px);
            opacity: 0.8;
            z-index: 2;
        }
        
        .chart-target:after {
            content: attr(data-label);
            font-size: 14px;
            position: absolute;
            right: 18px;
            max-width: 90px;
            background: white;
            border: 2px solid rgba(0, 0, 0, 0.1);
            padding: 0.4em 0.7em;
            border-radius: 4px;
            transform: translate(0, -50%);
        }
        
        .chart-band {
            position: absolute;
            left: 0;
            width: 100%;
            top: 0;
            height: 20%;
            mix-blend-mode: screen;
            pointer-events: none;
        }
        
        .chart-band--good {
            background-color: green;
        }
        
        .chart-band--average {
            top: 20%;
            height: 40%;
            background-color: #e58a2a
        }
        
        .chart-band--bad {
            top: 60%;
            height: 40%;
            background-color: #e6191d;
        }
    </style>
</head>

<body>
    <h1>Cumulative Layout Shift</h1>
    <h5>User breakdown %</h5>
    <div class="chart-con">
        <div class="chart-target" data-label="80% target"></div>
        <div class="chart-rail">
            <div class="chart">
                <div class="chart-wrap">
                    <canvas id="chart-1" width="160" height="90"></canvas>
                </div>
            </div>
        </div>
    </div>
    <h5>75pc score</h5>
    <div class="chart-con">
        <div class="chart-target" data-label="0.2 target" style="bottom: 84%"></div>
        <div class="chart-rail">
            <div class="chart">
                <div class="chart-wrap">
                    <div class="chart-band chart-band--good"><span></span> </div>
                    <div class="chart-band chart-band--average"><span></span></div>
                    <div class="chart-band chart-band--bad"><span></span></div>
                    <canvas id="chart-2" width="400" height="200"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        function drawchart(canvas, config) {
            canvas.parentNode.parentNode.style.width = `${50 * config.data.labels.length}px`;
            canvas.height = 90;
            canvas.width = `${10 * config.data.labels.length}`;
            canvas.parentNode.parentNode.parentNode.scrollTo(10000000, 0);
            const chart = new Chart(canvas, config);
        }

        const chart1 = document.getElementById('chart-1');
        const chart2 = document.getElementById('chart-2');

        const options = {
            responsive: true,
            maintainAspectRatio: true,
            layout: {
                padding: 0
            },
            plugins: {
                tooltip: {
                    enabled: false,
                    external: function(context) {
                        console.log(context);
                    }
                }
            }
        };

        const lineoptions = {
            pointBorderWidth: 2,
            pointRadius: 2,
            pointHoverBorderWidth: 4,
            pointBorderWidth: 5,
            pointHitRadius: 10,
            pointBackgroundColor: 'white',
            tension: 0.1
        };

        const chart1config = {
            type: 'line',
            data: {
                labels: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28],
                datasets: [{
                    label: 'Good',
                    data: [65, 59, 77, 77, 48, 66, 57, 40, 55, 59, 70, 90, 48, 56, 57, 40, 65, 59, 70, 90, 48, 56, 57, 40, 65, 46, 43],
                    borderColor: 'green',
                    pointBorderColor: "green",
                    ...lineoptions
                }, {
                    label: 'Average',
                    data: [16, 15, 17, 17, 14, 15, 15, 14, 16, 15, 17, 17, 14, 15, 15, 14, 16, 16, 15, 17, 17, 14, 15, 15, 14, 16, 15],
                    borderColor: '#e58a2a',
                    pointBorderColor: "#e58a2a",
                    ...lineoptions
                }, {
                    label: 'Bad',
                    data: [6, 5, 7, 7, 4, 5, 5, 4, 6, 5, 7, 7, 4, 5, 5, 4, 6],
                    borderColor: '#e6191d',
                    pointBorderColor: "#e6191d",
                    ...lineoptions
                }]
            },
            options: {
                ...options,
                scales: {
                    y: {
                        min: 0,
                        max: 100,
                        grid: {
                            display: false
                        }
                    },
                    x: {
                        grid: {
                            color: '#eee'
                        }
                    }
                }
            }
        };

        const chart2config = {
            type: 'line',
            data: {
                labels: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28],
                datasets: [{
                    label: 'CLS',
                    data: [0.2, 0.2, 0.23, 0.25, 0.45, 0.3, 0.2, 0.08, 0.16, 0.2, 0.24, 0.18, 0.1, 0.05, 0.2, 0.08, 0.16, 0.2, 0.24, 0.18, 0.1, 0.05, 0.18, 0.1, 0.05],
                    borderColor: 'black',
                    pointBorderColor: "black",
                    ...lineoptions
                }],
            },
            options: {
                ...options,
                scales: {
                    y: {
                        reverse: true,
                        min: 0
                    }
                }
            }
        }
        Chart.defaults.plugins.legend.display = false;
        Chart.defaults.scale.display = false;

        drawchart(chart1, chart1config);
        drawchart(chart2, chart2config);
    </script>
</body>

</html>